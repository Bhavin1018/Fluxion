import{produce as R}from"immer";function b(e,t={}){let{middleware:o=[],devtools:r=!1,name:s="ReactFlow Store"}=t,n={...e},c=new Set,a=()=>n,l=(d,T)=>{let f=d;for(let S of o){let g=S(f,T,i);g!==void 0&&(f=g)}return f},i=d=>{let T={...n},f;typeof d=="function"?f=R(n,g=>d(g)):f={...n,...d},o.length>0&&(f=l(f,T)),n=f,c.forEach(S=>S(n,T)),r&&typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__.connect({name:s}).send("UPDATE",n)},u=d=>(c.add(d),{unsubscribe:()=>{c.delete(d)}}),p=d=>d(n),y=()=>{c.clear()};return r&&typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__.connect({name:s}).init(n),{getState:a,setState:i,subscribe:u,use:p,destroy:y}}import{useEffect as E,useState as U,useRef as v,useCallback as K}from"react";function M(e){let t=s=>{let n=s||(i=>i),[c,a]=U(()=>n(e.getState())),l=v(c);return E(()=>{a(n(e.getState()));let i=e.subscribe(u=>{let p=n(u);D(p,l.current)||(l.current=p,a(p))});return()=>{i.unsubscribe()}},[]),[c,e.setState]};return{useStore:t,useSelector:s=>{let[n]=t(s);return n},useDispatch:()=>K(e.setState,[])}}function D(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;let o=Object.keys(e),r=Object.keys(t);if(o.length!==r.length)return!1;for(let s=0;s<o.length;s++){let n=o[s];if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1}return!0}function _(e={}){let{collapsed:t=!1,diff:o=!0}=e;return(r,s)=>{if(typeof window>"u")return r;if((t?console.groupCollapsed:console.group)("%c ReactFlow State Update","color: #4CAF50; font-weight: bold;"),console.log("%c Previous State","color: #9E9E9E; font-weight: bold;",s),console.log("%c Next State","color: #2196F3; font-weight: bold;",r),o){console.log("%c Differences","color: #FF5722; font-weight: bold;");let c=w(s,r);console.log(c)}return console.groupEnd(),r}}function F(e,t={}){let{blacklist:o=[]}=t,r={};if(typeof window<"u"&&window.localStorage)try{let s=localStorage.getItem(e);s&&(r=JSON.parse(s))}catch(s){console.error("Failed to load persisted state:",s)}return s=>{if(typeof window>"u"||!window.localStorage)return s;try{let n={...s};o.forEach(c=>{delete n[c]}),localStorage.setItem(e,JSON.stringify(n))}catch(n){console.error("Failed to persist state:",n)}return s}}function A(e){let t=0,o=null;return(r,s,n)=>{let c=Date.now();return c-t>=e?(t=c,r):(o=r,setTimeout(()=>{o&&(n(()=>o),o=null)},e-(c-t)),s)}}function w(e,t){if(e===t)return{};if(typeof e!="object"||e===null||typeof t!="object"||t===null)return{from:e,to:t};let o={};return Object.keys(e).forEach(r=>{if(!Object.prototype.hasOwnProperty.call(t,r))o[r]={from:e[r],to:void 0};else if(typeof e[r]=="object"&&e[r]!==null&&typeof t[r]=="object"&&t[r]!==null){let s=w(e[r],t[r]);Object.keys(s).length>0&&(o[r]=s)}else Object.is(e[r],t[r])||(o[r]={from:e[r],to:t[r]})}),Object.keys(t).forEach(r=>{Object.prototype.hasOwnProperty.call(e,r)||(o[r]={from:void 0,to:t[r]})}),o}function k(e,t={}){let{maxSnapshots:o=100,autoSnapshot:r=!1,autoSnapshotInterval:s=5e3}=t,n=[],c=-1,a=null,l=f=>{let S={state:{...e.getState()},timestamp:Date.now(),description:f};c<n.length-1&&(n=n.slice(0,c+1)),n.push(S),c=n.length-1,n.length>o&&(n.shift(),c--)},i=f=>{f>=0&&f<n.length&&(c=f,e.setState(()=>n[f].state))},u=()=>{n=[],c=-1},p=()=>c>0,y=()=>c<n.length-1,d=()=>{p()&&i(c-1)},T=()=>{y()&&i(c+1)};return r&&s>0&&(a=setInterval(()=>{l("Auto snapshot")},s)),l("Initial state"),{getSnapshots:()=>n,takeSnapshot:l,applySnapshot:i,clearSnapshots:u,canUndo:p,canRedo:y,undo:d,redo:T}}function L(e={}){let{snapshotFilter:t}=e;return(o,r,s)=>(!t||t(o,r),o)}function m(e){return function(o,r={}){let{actionName:s="async_action_"+Math.random().toString(36).substr(2,9),onStart:n,onSuccess:c,onError:a,onFinally:l}=r;return e(i=>{i.loading={...i.loading,[s]:!0},i.errors={...i.errors,[s]:null}}),n&&n(),o().then(i=>(e(u=>{u.loading={...u.loading,[s]:!1}}),c&&c(i),i)).catch(i=>{throw e(u=>{u.loading={...u.loading,[s]:!1},u.errors={...u.errors,[s]:i}}),a&&a(i),i}).finally(()=>{l&&l()})}}function J(){return e=>(e.loading||(e.loading={}),e.errors||(e.errors={}),e)}function I(e){return function(){let o=e();return m(o)}}function P(e,t){return!t||t.length===0?Object.values(e.loading).some(Boolean):t.some(o=>e.loading[o])}function N(e,t){if(!t||t.length===0)return e.errors;let o={};return t.forEach(r=>{o[r]=e.errors[r]||null}),o}function O(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;let o=Object.keys(e),r=Object.keys(t);if(o.length!==r.length)return!1;for(let s=0;s<o.length;s++){let n=o[s];if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1}return!0}function h(e,t={}){let{equalityFn:o=O,deps:r=[]}=t,s,n,c=r,a=l=>{if(c.length!==l.length)return!0;for(let i=0;i<l.length;i++)if(!Object.is(c[i],l[i]))return!0;return!1};return l=>{if(s&&n!==void 0&&(Object.is(l,s)||!a(r)))return n;let i=selector(l);return n!==void 0&&o(n,i)?n:(s=l,n=i,c=r,i)}}function x(e,t,o={}){return h(r=>{let s=e.map(n=>n(r));return t(s)},o)}function X(){return{createSelector:(e,t={})=>h(e,t),createCombinedSelector:(e,t,o={})=>x(e,t,o)}}function C(e,t){let o=()=>e.getState()[t];return{getSlice:o,setSlice:c=>{e.setState(a=>{if(typeof c=="function"){let l=c(a[t]);l!==void 0&&(a[t]={...a[t],...l})}else a[t]={...a[t],...c}})},select:c=>c(o()),slice:c=>j(e,t,c)}}function j(e,t,o){let r=()=>e.getState()[t][o];return{getSlice:r,setSlice:a=>{e.setState(l=>{if(typeof a=="function"){let i=a(l[t][o]);i!==void 0&&(l[t][o]={...l[t][o],...i})}else l[t][o]={...l[t][o],...a}})},select:a=>a(r()),slice:a=>{throw new Error("Nesting slices beyond 2 levels is not supported")}}}function q(e){return function(o){let[r,s]=e();return[r[o],a=>{s(l=>{if(typeof a=="function"){let i=a(l[o]);i!==void 0&&(l[o]={...l[o],...i})}else l[o]={...l[o],...a}})}]}}export{m as createAsyncAction,J as createAsyncMiddleware,x as createCombinedSelector,M as createHooks,_ as createLoggerMiddleware,F as createPersistMiddleware,h as createSelector,X as createSelectorFactory,C as createSlice,k as createSnapshotManager,L as createSnapshotMiddleware,b as createStore,A as createThrottleMiddleware,I as createUseAsyncAction,q as createUseSlice,N as getErrors,P as isLoading,O as shallowEqual};
